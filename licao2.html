<!DOCTYPE html>
<html lang="pt-br">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Librando - Aprender Libras</title>
  <link href="https://fonts.googleapis.com/css2?family=Baloo+Tamma+2:wght@400;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="css/estiloAtividades.css">
  <link rel="shortcut icon" type="image/x-icon" href="img/icone.png">
</head>

<body>

  <div class="container">
    <!-- Barra de progresso -->
    <div class="progress-bar">
      <div class="progress">
        <div class="reflexo"></div>
      </div>
    </div>

    <div class="main-content">

      <!-- Mascote + Balão -->
      <div class="mascot-section">
        <img src="img/LiliSentada.png" alt="Mascote" class="elephant">
        <div class="speech-bubble">Relembre um pouco do que ja aprendemos: </div>
      </div>

      <!-- Texto -->
      <h2>Revise as letras do alfabeto:</h2>

      <!-- Card da letra -->
      <div class="letter-card">
        <button id="prevButton" class="arrow-btn">‹</button>
        <img id="letterImage" class="container-zoom-permanente" src="gestos/a.JPG" alt="Letra A">
        <button id="nextButton" class="arrow-btn">›</button>
      </div>
      <p id="letterName" class="letter-name">"A"</p>
      <div class="footer">
        <!--botao troca de tela-->
        <p class="question">COMO VOCÊ SE CHAMA?
          <button id="finalbuton" class="arrow-btn" onclick="window.location.href='ordem2.html'">›</button>
        </p>

        <!-- Pergunta -->
      </div>
    </div>
  </div>


  <script>

    // === Dados ===
    // MODIFICADO: O array agora contém as letras de A-I e remove as frases.
    const letters = [
      { letter: "A", img: "gestos/a.JPG", name: "'A'" },
      { letter: "B", img: "gestos/b.JPG", name: "'B'" },
      { letter: "C", img: "gestos/c.JPG", name: "'C'" },
      { letter: "D", img: "gestos/d.JPG", name: "'D'" },
      { letter: "E", img: "gestos/e.JPG", name: "'E'" },
      { letter: "F", img: "gestos/f.JPG", name: "'F'" },      // Substituído "oi"
      { letter: "G", img: "gestos/g.JPG", name: "'G'" },      // Substituído "tchau"
      { letter: "H", img: "gestos/h.mp4", name: "'H'" },      // Substituído "sim"
      { letter: "I", img: "gestos/i.JPG", name: "'I'" },
      { letter: "MAE", img: "gestos/mae.mp4", name: "'Mãe'" },
      { letter: "PAI", img: "gestos/pai.mp4", name: "'Pai'" },
      { letter: "IRMAO", img: "gestos/irmao.mp4", name: "'Irmão'" },
      { letter: "TRISTE", img: "gestos/triste.mp4", name: "'Triste'" },
      { letter: "FELIZ", img: "gestos/feliz.mp4", name: "'Feliz'" },
    ];

    let currentIndex = 0;
    // MODIFICADO: A variável de controle agora se chama 'reachedF'.
    let reachedF = false; // vira true quando passar por 'F' e fica assim até o fim

    // === Elementos ===
    const letterImage = document.getElementById("letterImage");
    const letterName = document.getElementById("letterName");
    const nextButton = document.getElementById("nextButton");
    const prevButton = document.getElementById("prevButton"); // NOVO botão voltar
    const progressBar = document.querySelector(".progress");

    // Pegamos os elementos que terão o texto trocado SEM precisar mudar o HTML
    const speech = document.querySelector(".speech-bubble");
    const titleEl = document.querySelector("h2");
    const questionEl = document.querySelector(".question");

    // Guardamos os textos atuais como “padrão”
    const defaultSpeech = speech ? speech.textContent : "";
    const defaultTitle = titleEl ? titleEl.textContent : "";
    const questionTextNode = questionEl
      ? Array.from(questionEl.childNodes).find(n => n.nodeType === Node.TEXT_NODE)
      : null;
    const defaultQuestion = questionTextNode ? questionTextNode.textContent.trim() : "";

    // MODIFICADO: O objeto de textos foi renomeado para 'fTexts' para clareza.
    // Textos alvo quando atingir "F"
    const fTexts = {
      speech: "Hora de continuar aprendendo!",
      title: "Aprenda novos sinais:",
      question: "SINAIS BÁSICOS"
    };

    // Aplica os textos (com transição suave)
    const applyTexts = () => {
      // MODIFICADO: A condição agora usa 'reachedF' e 'fTexts'.
      const elements = [
        { el: speech, newText: reachedF ? fTexts.speech : defaultSpeech },
        { el: titleEl, newText: reachedF ? fTexts.title : defaultTitle },
        { el: questionTextNode, newText: reachedF ? `${fTexts.question} ` : `${defaultQuestion} ` }
      ];

      elements.forEach(item => {
        if (!item.el) return;

        // Para Node de texto (questionTextNode) tratamos diferente
        if (item.el.nodeType === Node.TEXT_NODE) {
          const parent = item.el.parentElement;
          parent.classList.add("fade-text");
          parent.classList.add("fade-out");

          setTimeout(() => {
            item.el.textContent = item.newText;
            parent.classList.remove("fade-out");
          }, 400);
        } else {
          item.el.classList.add("fade-text");
          item.el.classList.add("fade-out");

          setTimeout(() => {
            item.el.textContent = item.newText;
            item.el.classList.remove("fade-out");
          }, 400);
        }
      });
    };

    // Atualiza passo (imagem, nome, barra e textos)
    const updateStep = () => {
      const item = letters[currentIndex];

      // Seleciona a moldura
      const letterCard = document.querySelector(".letter-card");

      // Remove vídeo antigo se existir
      let oldVideo = document.getElementById("letterVideo");
      if (oldVideo) oldVideo.remove();

      if (item.img.endsWith(".mp4") || item.img.endsWith(".webm")) {
        // Se for vídeo, esconde imagem e adiciona vídeo
        letterImage.style.display = "none";

        const video = document.createElement("video");
        video.id = "letterVideo";
        video.src = item.img;
        video.autoplay = true;
        video.loop = true;
        video.muted = true;
        video.playsInline = true; // melhora em mobile
        video.style.width = "220px";
        video.style.height = "220px";
        video.style.borderRadius = "15px";
        video.style.objectFit = "cover";
        video.style.boxShadow = "0px 4px 8px rgba(0,0,0,0.1)";
        video.style.border = "4px solid #75429E"; // ou #ddd se quiser

        // Adiciona antes do botão "next"
        letterCard.insertBefore(video, nextButton);
      } else {
        // Se for imagem, remove vídeo e mostra imagem
        letterImage.style.display = "block";
        letterImage.src = item.img;
      }

      if (letterName) letterName.textContent = item.name;
      if (progressBar) progressBar.style.width = `${((currentIndex + 1) / letters.length) * 100}%`;

      // MODIFICADO: A lógica agora verifica se a letra 'F' foi alcançada.
      reachedF = false;
      for (let i = 0; i <= currentIndex; i++) {
        if (letters[i].letter.toUpperCase() === "F") {
          reachedF = true;
          break;
        }
      }

      applyTexts();

      // === Controle do botão final ===
      const finalButton = document.getElementById("finalbuton");
      if (currentIndex === letters.length - 1) {
        finalButton.style.display = "inline-block"; // Mostra no último item
      } else {
        finalButton.style.display = "none"; // Esconde se não for o último
      }
    };

    // Clique do botão “próximo”
    if (nextButton) {
      nextButton.addEventListener("click", () => {
        // Se não estiver no último item, avança
        if (currentIndex < letters.length - 1) {
          currentIndex++;
          updateStep();
        }
      });
    }

    // Clique do botão “voltar”
    if (prevButton) {
      prevButton.addEventListener("click", () => {
        // Se não estiver no primeiro item, volta
        if (currentIndex > 0) {
          currentIndex--;
          updateStep();
        }
      });
    }

    // Garante que os textos corretos estejam aplicados no carregamento
    applyTexts();

    // Adiciona os outros eventos que estavam no JS da lição 1 para consistência
    const letterCard = document.querySelector(".letter-card");

    document.addEventListener('keydown', e => {
      if (e.key === 'ArrowRight') nextButton?.click();
      if (e.key === 'ArrowLeft') prevButton?.click();
    });

    letterCard?.addEventListener('click', e => {
      if (e.target.tagName !== 'BUTTON' && e.target.parentElement.tagName !== 'BUTTON') {
        nextButton?.click();
      }
    });

    // Inicializa o primeiro passo
    updateStep();

  </script>

</body>

</html>
